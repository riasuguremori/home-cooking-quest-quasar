import{Q as f}from"./QToolbarTitle-uhcdwykv.js";import{Q as g}from"./QMenu-DHbgiscJ.js";import{z as m,h as b,o as _,j as a,b as n,e as t,Q,M as v,S as h,L as y}from"./index-CCltDTcc.js";import{Q as w}from"./QToolbar-DVqQvwW-.js";import{a as k,Q as C}from"./QTable-D19l5PzE.js";import{Q as T}from"./QPage-DfUJbLHa.js";import{u as V}from"./use-quasar-CUmE3VzD.js";import{c as d}from"./comment-D-Ok87oV.js";import"./position-engine-DhZ2HoGy.js";import"./selection-CUV_63Hm.js";import"./QVirtualScroll-CF7Nsi2E.js";import"./QChip-X1ikjzpS.js";import"./QList-D8PYKg1x.js";import"./QItemLabel-7_chNhSH.js";import"./format-hlGAdIUH.js";import"./use-fullscreen-CrZqwLof.js";const x={class:"q-pa-md"},B={class:"row"},S={class:"col-12"},K={__name:"commentsPage",setup(A){const r=V(),i=m([]),s=m(""),p=[{name:"content",label:"內容",field:"content",align:"left"},{name:"author",label:"發文者",field:e=>e.author.account,align:"left",sortable:!0},{name:"likes",label:"按讚人數",field:e=>e.likes?.length||0,align:"right",sortable:!0},{name:"recipe",label:"食譜留言",field:e=>e.recipe?.name||"",align:"left",sortable:!0},{name:"article",label:"文章留言",field:e=>e.article?.title||"",align:"left",sortable:!0},{name:"createdAt",label:"創建日期",field:"createdAt",format:e=>new Date(e).toLocaleString(),align:"left",sortable:!0},{name:"actions",label:"操作",align:"center"}],c=async()=>{try{const{data:e}=await d.getAllComment();i.value=e.result}catch(e){console.log(e),r.notify({message:"取得留言失敗",color:"negative"})}},u=e=>{r.dialog({title:"確認刪除",message:`你確定要刪除留言 "${e.content}" 嗎？`,cancel:!0,persistent:!0}).onOk(async()=>{try{await d.deleteComment(e._id),r.notify({color:"positive",message:"刪除成功"}),c()}catch(o){console.log(o);const l=o?.response?.data?.message||"發生錯誤";r.notify({color:"negative",message:l})}})};return c(),(e,o)=>(_(),b(T,{padding:""},{default:a(()=>[n("div",x,[n("div",B,[n("div",S,[t(k,{rows:i.value,columns:p,"row-key":"_id",flat:"",bordered:"",filter:s.value},{top:a(()=>[t(w,null,{default:a(()=>[t(f,null,{default:a(()=>[...o[1]||(o[1]=[v("留言管理",-1)])]),_:1}),t(g),t(h,{modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=l=>s.value=l),dense:"",debounce:"500",placeholder:"搜尋",color:"primary"},{append:a(()=>[t(y,{name:"search"})]),_:1},8,["modelValue"])]),_:1})]),"body-cell-actions":a(l=>[t(C,{props:l},{default:a(()=>[t(Q,{icon:"delete",flat:"",round:"",onClick:N=>u(l.row)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","filter"])])])])]),_:1}))}};export{K as default};
