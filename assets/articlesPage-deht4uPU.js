import{Q as y}from"./QToolbarTitle-uhcdwykv.js";import{Q as w}from"./QMenu-DHbgiscJ.js";import{z as m,h as d,o as u,j as a,b as s,e as o,Q as h,t as f,M as p,a as v,S as x,L as k}from"./index-CCltDTcc.js";import{Q as A}from"./QToolbar-DVqQvwW-.js";import{Q as T}from"./QImg-48OQTr1V.js";import{a as V,Q as n}from"./QTable-D19l5PzE.js";import{Q as S}from"./QTooltip-BAXmC6CC.js";import{Q as B}from"./QPage-DfUJbLHa.js";import{u as C}from"./use-quasar-CUmE3VzD.js";import{a as g}from"./article-B42tPgpF.js";import"./position-engine-DhZ2HoGy.js";import"./selection-CUV_63Hm.js";import"./QVirtualScroll-CF7Nsi2E.js";import"./QChip-X1ikjzpS.js";import"./QList-D8PYKg1x.js";import"./QItemLabel-7_chNhSH.js";import"./format-hlGAdIUH.js";import"./use-fullscreen-CrZqwLof.js";const N={class:"q-pa-md"},U={class:"row"},I={class:"col-12"},$={class:"ellipsis"},te={__name:"articlesPage",setup(j){const r=C(),c=m([]),i=m(""),b=[{name:"image",label:"圖片",field:"image",align:"left"},{name:"title",label:"標題",field:"title",align:"left"},{name:"content",label:"內容",field:"content",align:"left"},{name:"category",label:"分類",field:"category",format:e=>e||"未知",align:"left",sortable:!0},{name:"author",label:"發文者",field:e=>e.author.account,align:"left",sortable:!0},{name:"likes",label:"追蹤人數",field:e=>e.author.account,align:"left",sortable:!0},{name:"createdAt",label:"創建日期",field:"createdAt",format:e=>new Date(e).toLocaleString(),align:"left",sortable:!0},{name:"actions",label:"操作",align:"center"}],_=async()=>{try{const{data:e}=await g.getAllArticle();c.value=e.result}catch(e){console.log(e),r.notify({message:"取得文章失敗",color:"negative"})}},Q=async e=>{r.dialog({title:"確認刪除",message:`你確定要刪除文章 "${e.title}" 嗎？`,cancel:!0,persistent:!0}).onOk(async()=>{try{await g.deleteArticle(e._id),r.notify({color:"positive",message:"刪除成功"})}catch(l){console.log(l);const t=l?.response?.data?.message||"發生錯誤";r.notify({color:"negative",message:t})}})};return _(),(e,l)=>(u(),d(B,{padding:""},{default:a(()=>[s("div",N,[s("div",U,[s("div",I,[o(V,{rows:c.value,columns:b,"row-key":"_id",flat:"",bordered:"",filter:i.value},{top:a(()=>[o(A,null,{default:a(()=>[o(y,null,{default:a(()=>[...l[1]||(l[1]=[p("文章管理",-1)])]),_:1}),o(w),o(x,{modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=t=>i.value=t),dense:"",debounce:"500",placeholder:"搜尋",color:"primary"},{append:a(()=>[o(k,{name:"search"})]),_:1},8,["modelValue"])]),_:1})]),"body-cell-image":a(t=>[o(n,{props:t},{default:a(()=>[t.row.imageUrl&&t.row.imageUrl.length>0?(u(),d(T,{key:0,src:t.row.imageUrl[0],style:{width:"100px",height:"60px","border-radius":"8px","object-fit":"cover"}},null,8,["src"])):v("",!0)]),_:2},1032,["props"])]),"body-cell-content":a(t=>[o(n,{props:t,style:{"max-width":"300px"}},{default:a(()=>[s("div",$,f(t.row.content),1),o(S,null,{default:a(()=>[p(f(t.row.content),1)]),_:2},1024)]),_:2},1032,["props"])]),"body-cell-actions":a(t=>[o(n,{props:t},{default:a(()=>[o(h,{icon:"delete",flat:"",round:"",onClick:q=>Q(t.row)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","filter"])])])])]),_:1}))}};export{te as default};
