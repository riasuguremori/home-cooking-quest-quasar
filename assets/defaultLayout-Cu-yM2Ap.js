import{p as m,q as gt,u as Bt,s as At,v as Tt,x as Rt,y as Ft,z as A,A as $t,B as de,C as lt,l as d,D as fe,E as Nt,G as Et,Q as D,H as zt,I as Pt,h as j,o as x,j as s,J as Ut,f as Jt,e as i,b as y,K as M,L as ae,c as $,a as L,F as K,i as De,M as C,t as p,n as nt,N as ge,O as ot,P as rt,R as it,S as Wt,U as ut}from"./index-CCltDTcc.js";import{Q as Kt,a as ke}from"./QMenu-DHbgiscJ.js";import{Q as Ae}from"./QTooltip-BAXmC6CC.js";import{u as Gt}from"./use-render-cache-DLxPkVnQ.js";import{t as Xt,a as st,f as Zt,g as ea,j as Te,_ as ta,d as Re}from"./date-BdkF2Xzz.js";import{p as le}from"./format-hlGAdIUH.js";import{Q as G}from"./QItemLabel-7_chNhSH.js";import{Q as Fe,a as Ce,b as N}from"./QList-D8PYKg1x.js";import{Q as dt}from"./QChip-X1ikjzpS.js";import{Q as aa}from"./QToolbar-DVqQvwW-.js";import{Q as la,a as na,b as oa}from"./QLayout-DbxfmJl-.js";import{Q as ra}from"./QScrollArea-CmzUWhe-.js";import{Q as ia}from"./QPageContainer-CLUIcwg7.js";import"./position-engine-DhZ2HoGy.js";import"./selection-CUV_63Hm.js";import"./QResizeObserver-B-ajq8rO.js";import"./TouchPan-Bw1igJGw.js";import"./touch-BjYP5sR0.js";const ua=["gregorian","persian"],ct={mask:{type:String},locale:Object,calendar:{type:String,validator:a=>ua.includes(a),default:"gregorian"},landscape:Boolean,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,readonly:Boolean,disable:Boolean},sa=["update:modelValue"];function X(a){return a.year+"/"+le(a.month)+"/"+le(a.day)}function da(a,E){const g=m(()=>a.disable!==!0&&a.readonly!==!0),Q=m(()=>g.value===!0?0:-1),w=m(()=>{const q=[];return a.color!==void 0&&q.push(`bg-${a.color}`),a.textColor!==void 0&&q.push(`text-${a.textColor}`),q.join(" ")});function J(){return a.locale!==void 0?{...E.lang.date,...a.locale}:E.lang.date}function Y(q){const S=new Date,R=q===!0?null:0;if(a.calendar==="persian"){const z=Xt(S);return{year:z.jy,month:z.jm,day:z.jd}}return{year:S.getFullYear(),month:S.getMonth()+1,day:S.getDate(),hour:R,minute:R,second:R,millisecond:R}}return{editable:g,tabindex:Q,headerClass:w,getLocale:J,getCurrentDate:Y}}const U=20,ca=["Calendar","Years","Months"],vt=a=>ca.includes(a),$e=a=>/^-?[\d]+\/[0-1]\d$/.test(a),se=" — ";function Z(a){return a.year+"/"+le(a.month)}const mt=gt({name:"QDate",props:{...ct,...At,...Bt,modelValue:{required:!0,validator:a=>typeof a=="string"||Array.isArray(a)===!0||Object(a)===a||a===null},multiple:Boolean,range:Boolean,title:String,subtitle:String,mask:{...ct.mask,default:"YYYY/MM/DD"},defaultYearMonth:{type:String,validator:$e},yearsInMonthView:Boolean,events:[Array,Function],eventColor:[String,Function],emitImmediately:Boolean,options:[Array,Function],navigationMinYearMonth:{type:String,validator:$e},navigationMaxYearMonth:{type:String,validator:$e},noUnset:Boolean,firstDayOfWeek:[String,Number],todayBtn:Boolean,minimal:Boolean,defaultView:{type:String,default:"Calendar",validator:vt}},emits:[...sa,"rangeStart","rangeEnd","navigation"],setup(a,{slots:E,emit:g}){const{proxy:Q}=Tt(),{$q:w}=Q,J=Rt(a,w),{getCache:Y}=Gt(),{tabindex:q,headerClass:S,getLocale:R,getCurrentDate:z}=da(a,w);let ne;const k=Ft(a),v=Et(k),F=A(null),u=A(Ke()),b=A(R()),ht=m(()=>Ke()),yt=m(()=>R()),P=m(()=>z()),c=A(Ge(u.value,b.value)),O=A(a.defaultView),Ne=m(()=>w.lang.rtl===!0?"right":"left"),he=A(Ne.value),Me=A(Ne.value),pe=c.value.year,ye=A(pe-pe%U-(pe<0?U:0)),I=A(null),_t=m(()=>{const e=a.landscape===!0?"landscape":"portrait";return`q-date q-date--${e} q-date--${e}-${a.minimal===!0?"minimal":"standard"}`+(J.value===!0?" q-date--dark q-dark":"")+(a.bordered===!0?" q-date--bordered":"")+(a.square===!0?" q-date--square no-border-radius":"")+(a.flat===!0?" q-date--flat no-shadow":"")+(a.disable===!0?" disabled":a.readonly===!0?" q-date--readonly":"")}),ee=m(()=>a.color||"primary"),oe=m(()=>a.textColor||"white"),_e=m(()=>a.emitImmediately===!0&&a.multiple!==!0&&a.range!==!0),Ye=m(()=>Array.isArray(a.modelValue)===!0?a.modelValue:a.modelValue!==null&&a.modelValue!==void 0?[a.modelValue]:[]),T=m(()=>Ye.value.filter(e=>typeof e=="string").map(e=>Le(e,u.value,b.value)).filter(e=>e.dateHash!==null&&e.day!==null&&e.month!==null&&e.year!==null)),re=m(()=>{const e=t=>Le(t,u.value,b.value);return Ye.value.filter(t=>$t(t)===!0&&t.from!==void 0&&t.to!==void 0).map(t=>({from:e(t.from),to:e(t.to)})).filter(t=>t.from.dateHash!==null&&t.to.dateHash!==null&&t.from.dateHash<t.to.dateHash)}),be=m(()=>a.calendar!=="persian"?e=>new Date(e.year,e.month-1,e.day):e=>{const t=st(e.year,e.month,e.day);return new Date(t.gy,t.gm-1,t.gd)}),Ve=m(()=>a.calendar==="persian"?X:(e,t,l)=>Zt(new Date(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond),t===void 0?u.value:t,l===void 0?b.value:l,e.year,e.timezoneOffset)),ce=m(()=>T.value.length+re.value.reduce((e,t)=>e+1+ea(be.value(t.to),be.value(t.from)),0)),Ee=m(()=>{if(a.title!==void 0&&a.title!==null&&a.title.length!==0)return a.title;if(I.value!==null){const l=I.value.init,n=be.value(l);return b.value.daysShort[n.getDay()]+", "+b.value.monthsShort[l.month-1]+" "+l.day+se+"?"}if(ce.value===0)return se;if(ce.value>1)return`${ce.value} ${b.value.pluralDay}`;const e=T.value[0],t=be.value(e);return isNaN(t.valueOf())===!0?se:b.value.headerTitle!==void 0?b.value.headerTitle(t,e):b.value.daysShort[t.getDay()]+", "+b.value.monthsShort[e.month-1]+" "+e.day}),bt=m(()=>T.value.concat(re.value.map(t=>t.from)).sort((t,l)=>t.year-l.year||t.month-l.month)[0]),xt=m(()=>T.value.concat(re.value.map(t=>t.to)).sort((t,l)=>l.year-t.year||l.month-t.month)[0]),ze=m(()=>{if(a.subtitle!==void 0&&a.subtitle!==null&&a.subtitle.length!==0)return a.subtitle;if(ce.value===0)return se;if(ce.value>1){const e=bt.value,t=xt.value,l=b.value.monthsShort;return l[e.month-1]+(e.year!==t.year?" "+e.year+se+l[t.month-1]+" ":e.month!==t.month?se+l[t.month-1]:"")+" "+t.year}return T.value[0].year}),xe=m(()=>{const e=[w.iconSet.datetime.arrowLeft,w.iconSet.datetime.arrowRight];return w.lang.rtl===!0?e.reverse():e}),Pe=m(()=>a.firstDayOfWeek!==void 0?Number(a.firstDayOfWeek):b.value.firstDayOfWeek),wt=m(()=>{const e=b.value.daysShort,t=Pe.value;return t>0?e.slice(t,7).concat(e.slice(0,t)):e}),W=m(()=>{const e=c.value;return a.calendar!=="persian"?new Date(e.year,e.month,0).getDate():Te(e.year,e.month)}),qt=m(()=>typeof a.eventColor=="function"?a.eventColor:()=>a.eventColor),V=m(()=>{if(a.navigationMinYearMonth===void 0)return null;const e=a.navigationMinYearMonth.split("/");return{year:parseInt(e[0],10),month:parseInt(e[1],10)}}),H=m(()=>{if(a.navigationMaxYearMonth===void 0)return null;const e=a.navigationMaxYearMonth.split("/");return{year:parseInt(e[0],10),month:parseInt(e[1],10)}}),He=m(()=>{const e={month:{prev:!0,next:!0},year:{prev:!0,next:!0}};return V.value!==null&&V.value.year>=c.value.year&&(e.year.prev=!1,V.value.year===c.value.year&&V.value.month>=c.value.month&&(e.month.prev=!1)),H.value!==null&&H.value.year<=c.value.year&&(e.year.next=!1,H.value.year===c.value.year&&H.value.month<=c.value.month&&(e.month.next=!1)),e}),we=m(()=>{const e={};return T.value.forEach(t=>{const l=Z(t);e[l]===void 0&&(e[l]=[]),e[l].push(t.day)}),e}),Ue=m(()=>{const e={};return re.value.forEach(t=>{const l=Z(t.from),n=Z(t.to);if(e[l]===void 0&&(e[l]=[]),e[l].push({from:t.from.day,to:l===n?t.to.day:void 0,range:t}),l<n){let o;const{year:h,month:r}=t.from,f=r<12?{year:h,month:r+1}:{year:h+1,month:1};for(;(o=Z(f))<=n;)e[o]===void 0&&(e[o]=[]),e[o].push({from:void 0,to:o===n?t.to.day:void 0,range:t}),f.month++,f.month>12&&(f.year++,f.month=1)}}),e}),ve=m(()=>{if(I.value===null)return;const{init:e,initHash:t,final:l,finalHash:n}=I.value,[o,h]=t<=n?[e,l]:[l,e],r=Z(o),f=Z(h);if(r!==B.value&&f!==B.value)return;const _={};return r===B.value?(_.from=o.day,_.includeFrom=!0):_.from=1,f===B.value?(_.to=h.day,_.includeTo=!0):_.to=W.value,_}),B=m(()=>Z(c.value)),Dt=m(()=>{const e={};if(a.options===void 0){for(let l=1;l<=W.value;l++)e[l]=!0;return e}const t=typeof a.options=="function"?a.options:l=>a.options.includes(l);for(let l=1;l<=W.value;l++){const n=B.value+"/"+le(l);e[l]=t(n)}return e}),kt=m(()=>{const e={};if(a.events===void 0)for(let t=1;t<=W.value;t++)e[t]=!1;else{const t=typeof a.events=="function"?a.events:l=>a.events.includes(l);for(let l=1;l<=W.value;l++){const n=B.value+"/"+le(l);e[l]=t(n)===!0&&qt.value(n)}}return e}),Ct=m(()=>{let e,t;const{year:l,month:n}=c.value;if(a.calendar!=="persian")e=new Date(l,n-1,1),t=new Date(l,n-1,0).getDate();else{const o=st(l,n,1);e=new Date(o.gy,o.gm-1,o.gd);let h=n-1,r=l;h===0&&(h=12,r--),t=Te(r,h)}return{days:e.getDay()-Pe.value-1,endDay:t}}),Je=m(()=>{const e=[],{days:t,endDay:l}=Ct.value,n=t<0?t+7:t;if(n<6)for(let r=l-n;r<=l;r++)e.push({i:r,fill:!0});const o=e.length;for(let r=1;r<=W.value;r++){const f={i:r,event:kt.value[r],classes:[]};Dt.value[r]===!0&&(f.in=!0,f.flat=!0),e.push(f)}if(we.value[B.value]!==void 0&&we.value[B.value].forEach(r=>{const f=o+r-1;Object.assign(e[f],{selected:!0,unelevated:!0,flat:!1,color:ee.value,textColor:oe.value})}),Ue.value[B.value]!==void 0&&Ue.value[B.value].forEach(r=>{if(r.from!==void 0){const f=o+r.from-1,_=o+(r.to||W.value)-1;for(let me=f;me<=_;me++)Object.assign(e[me],{range:r.range,unelevated:!0,color:ee.value,textColor:oe.value});Object.assign(e[f],{rangeFrom:!0,flat:!1}),r.to!==void 0&&Object.assign(e[_],{rangeTo:!0,flat:!1})}else if(r.to!==void 0){const f=o+r.to-1;for(let _=o;_<=f;_++)Object.assign(e[_],{range:r.range,unelevated:!0,color:ee.value,textColor:oe.value});Object.assign(e[f],{flat:!1,rangeTo:!0})}else{const f=o+W.value-1;for(let _=o;_<=f;_++)Object.assign(e[_],{range:r.range,unelevated:!0,color:ee.value,textColor:oe.value})}}),ve.value!==void 0){const r=o+ve.value.from-1,f=o+ve.value.to-1;for(let _=r;_<=f;_++)e[_].color=ee.value,e[_].editRange=!0;ve.value.includeFrom===!0&&(e[r].editRangeFrom=!0),ve.value.includeTo===!0&&(e[f].editRangeTo=!0)}c.value.year===P.value.year&&c.value.month===P.value.month&&(e[o+P.value.day-1].today=!0);const h=e.length%7;if(h>0){const r=7-h;for(let f=1;f<=r;f++)e.push({i:f,fill:!0})}return e.forEach(r=>{let f="q-date__calendar-item ";r.fill===!0?f+="q-date__calendar-item--fill":(f+=`q-date__calendar-item--${r.in===!0?"in":"out"}`,r.range!==void 0&&(f+=` q-date__range${r.rangeTo===!0?"-to":r.rangeFrom===!0?"-from":""}`),r.editRange===!0&&(f+=` q-date__edit-range${r.editRangeFrom===!0?"-from":""}${r.editRangeTo===!0?"-to":""}`),(r.range!==void 0||r.editRange===!0)&&(f+=` text-${r.color}`)),r.classes=f}),e}),Mt=m(()=>a.disable===!0?{"aria-disabled":"true"}:{});de(()=>a.modelValue,e=>{if(ne===JSON.stringify(e))ne=0;else{const t=Ge(u.value,b.value);ie(t.year,t.month,t)}}),de(O,()=>{F.value!==null&&Q.$el.contains(document.activeElement)===!0&&F.value.focus()}),de(()=>c.value.year+"|"+c.value.month,()=>{g("navigation",{year:c.value.year,month:c.value.month})}),de(ht,e=>{at(e,b.value,"mask"),u.value=e}),de(yt,e=>{at(u.value,e,"locale"),b.value=e});function Se(e){ne=JSON.stringify(e)}function We(){const{year:e,month:t,day:l}=P.value,n={...c.value,year:e,month:t,day:l},o=we.value[Z(n)];(o===void 0||o.includes(n.day)===!1)&&Oe(n),Ie(n.year,n.month)}function pt(e){vt(e)===!0&&(O.value=e)}function Yt(e,t){["month","year"].includes(e)&&(e==="month"?Ze:Qe)(t===!0?-1:1)}function Ie(e,t){O.value="Calendar",ie(e,t)}function Vt(e,t){if(a.range===!1||!e){I.value=null;return}const l=Object.assign({...c.value},e),n=t!==void 0?Object.assign({...c.value},t):l;I.value={init:l,initHash:X(l),final:n,finalHash:X(n)},Ie(l.year,l.month)}function Ke(){return a.calendar==="persian"?"YYYY/MM/DD":a.mask}function Le(e,t,l){return ta(e,t,l,a.calendar,{hour:0,minute:0,second:0,millisecond:0})}function Ge(e,t){const l=Array.isArray(a.modelValue)===!0?a.modelValue:a.modelValue?[a.modelValue]:[];if(l.length===0)return Xe();const n=l[l.length-1],o=Le(n.from!==void 0?n.from:n,e,t);return o.dateHash===null?Xe():o}function Xe(){let e,t;if(a.defaultYearMonth!==void 0){const l=a.defaultYearMonth.split("/");e=parseInt(l[0],10),t=parseInt(l[1],10)}else{const l=P.value!==void 0?P.value:z();e=l.year,t=l.month}return{year:e,month:t,day:1,hour:0,minute:0,second:0,millisecond:0,dateHash:e+"/"+le(t)+"/01"}}function Ze(e){let t=c.value.year,l=Number(c.value.month)+e;l===13?(l=1,t++):l===0&&(l=12,t--),ie(t,l),_e.value===!0&&qe("month")}function Qe(e){const t=Number(c.value.year)+e;ie(t,c.value.month),_e.value===!0&&qe("year")}function Ht(e){ie(e,c.value.month),O.value=a.defaultView==="Years"?"Months":"Calendar",_e.value===!0&&qe("year")}function St(e){ie(c.value.year,e),O.value="Calendar",_e.value===!0&&qe("month")}function It(e,t){(we.value[t]?.includes(e.day)===!0?je:Oe)(e)}function te(e){return{year:e.year,month:e.month,day:e.day}}function ie(e,t,l){if(V.value!==null&&e<=V.value.year&&((t<V.value.month||e<V.value.year)&&(t=V.value.month),e=V.value.year),H.value!==null&&e>=H.value.year&&((t>H.value.month||e>H.value.year)&&(t=H.value.month),e=H.value.year),l!==void 0){const{hour:o,minute:h,second:r,millisecond:f,timezoneOffset:_,timeHash:me}=l;Object.assign(c.value,{hour:o,minute:h,second:r,millisecond:f,timezoneOffset:_,timeHash:me})}const n=e+"/"+le(t)+"/01";n!==c.value.dateHash&&(he.value=c.value.dateHash<n==(w.lang.rtl!==!0)?"left":"right",e!==c.value.year&&(Me.value=he.value),lt(()=>{ye.value=e-e%U-(e<0?U:0),Object.assign(c.value,{year:e,month:t,day:1,dateHash:n})}))}function et(e,t,l){const n=e!==null&&e.length===1&&a.multiple===!1?e[0]:e,{reason:o,details:h}=tt(t,l);Se(n),g("update:modelValue",n,o,h)}function qe(e){const t=T.value[0]!==void 0&&T.value[0].dateHash!==null?{...T.value[0]}:{...c.value};lt(()=>{t.year=c.value.year,t.month=c.value.month;const l=a.calendar!=="persian"?new Date(t.year,t.month,0).getDate():Te(t.year,t.month);t.day=Math.min(Math.max(1,t.day),l);const n=ue(t),{details:o}=tt("",t);Se(n),g("update:modelValue",n,e,o)})}function tt(e,t){return t.from!==void 0?{reason:`${e}-range`,details:{...te(t.target),from:te(t.from),to:te(t.to)}}:{reason:`${e}-day`,details:te(t)}}function ue(e,t,l){return e.from!==void 0?{from:Ve.value(e.from,t,l),to:Ve.value(e.to,t,l)}:Ve.value(e,t,l)}function Oe(e){let t;if(a.multiple===!0)if(e.from!==void 0){const l=X(e.from),n=X(e.to),o=T.value.filter(r=>r.dateHash<l||r.dateHash>n),h=re.value.filter(({from:r,to:f})=>f.dateHash<l||r.dateHash>n);t=o.concat(h).concat(e).map(r=>ue(r))}else{const l=Ye.value.slice();l.push(ue(e)),t=l}else t=ue(e);et(t,"add",e)}function je(e){if(a.noUnset===!0)return;let t=null;if(a.multiple===!0&&Array.isArray(a.modelValue)===!0){const l=ue(e);e.from!==void 0?t=a.modelValue.filter(n=>n.from!==void 0?n.from!==l.from&&n.to!==l.to:!0):t=a.modelValue.filter(n=>n!==l),t.length===0&&(t=null)}et(t,"remove",e)}function at(e,t,l){const n=T.value.concat(re.value).map(h=>ue(h,e,t)).filter(h=>h.from!==void 0?h.from.dateHash!==null&&h.to.dateHash!==null:h.dateHash!==null),o=(a.multiple===!0?n:n[0])||null;Se(o),g("update:modelValue",o,l)}function Lt(){if(a.minimal!==!0)return d("div",{class:"q-date__header "+S.value},[d("div",{class:"relative-position"},[d(fe,{name:"q-transition--fade"},()=>d("div",{key:"h-yr-"+ze.value,class:"q-date__header-subtitle q-date__header-link "+(O.value==="Years"?"q-date__header-link--active":"cursor-pointer"),tabindex:q.value,...Y("vY",{onClick(){O.value="Years"},onKeyup(e){e.keyCode===13&&(O.value="Years")}})},[ze.value]))]),d("div",{class:"q-date__header-title relative-position flex no-wrap"},[d("div",{class:"relative-position col"},[d(fe,{name:"q-transition--fade"},()=>d("div",{key:"h-sub"+Ee.value,class:"q-date__header-title-label q-date__header-link "+(O.value==="Calendar"?"q-date__header-link--active":"cursor-pointer"),tabindex:q.value,...Y("vC",{onClick(){O.value="Calendar"},onKeyup(e){e.keyCode===13&&(O.value="Calendar")}})},[Ee.value]))]),a.todayBtn===!0?d(D,{class:"q-date__header-today self-start",icon:w.iconSet.datetime.today,"aria-label":w.lang.date.today,flat:!0,size:"sm",round:!0,tabindex:q.value,onClick:We}):null])])}function Be({label:e,type:t,key:l,dir:n,goTo:o,boundaries:h,cls:r}){return[d("div",{class:"row items-center q-date__arrow"},[d(D,{round:!0,dense:!0,size:"sm",flat:!0,icon:xe.value[0],"aria-label":t==="Years"?w.lang.date.prevYear:w.lang.date.prevMonth,tabindex:q.value,disable:h.prev===!1,...Y("go-#"+t,{onClick(){o(-1)}})})]),d("div",{class:"relative-position overflow-hidden flex flex-center"+r},[d(fe,{name:"q-transition--jump-"+n},()=>d("div",{key:l},[d(D,{flat:!0,dense:!0,noCaps:!0,label:e,tabindex:q.value,...Y("view#"+t,{onClick:()=>{O.value=t}})})]))]),d("div",{class:"row items-center q-date__arrow"},[d(D,{round:!0,dense:!0,size:"sm",flat:!0,icon:xe.value[1],"aria-label":t==="Years"?w.lang.date.nextYear:w.lang.date.nextMonth,tabindex:q.value,disable:h.next===!1,...Y("go+#"+t,{onClick(){o(1)}})})])]}const Qt={Calendar:()=>[d("div",{key:"calendar-view",class:"q-date__view q-date__calendar"},[d("div",{class:"q-date__navigation row items-center no-wrap"},Be({label:b.value.months[c.value.month-1],type:"Months",key:c.value.month,dir:he.value,goTo:Ze,boundaries:He.value.month,cls:" col"}).concat(Be({label:c.value.year,type:"Years",key:c.value.year,dir:Me.value,goTo:Qe,boundaries:He.value.year,cls:""}))),d("div",{class:"q-date__calendar-weekdays row items-center no-wrap"},wt.value.map(e=>d("div",{class:"q-date__calendar-item"},[d("div",e)]))),d("div",{class:"q-date__calendar-days-container relative-position overflow-hidden"},[d(fe,{name:"q-transition--slide-"+he.value},()=>d("div",{key:B.value,class:"q-date__calendar-days fit"},Je.value.map(e=>d("div",{class:e.classes},[e.in===!0?d(D,{class:e.today===!0?"q-date__today":"",dense:!0,flat:e.flat,unelevated:e.unelevated,color:e.color,textColor:e.textColor,label:e.i,tabindex:q.value,...Y("day#"+e.i,{onClick:()=>{Ot(e.i)},onMouseover:()=>{jt(e.i)}})},e.event!==!1?()=>d("div",{class:"q-date__event bg-"+e.event}):null):d("div",""+e.i)]))))])])],Months(){const e=c.value.year===P.value.year,t=n=>V.value!==null&&c.value.year===V.value.year&&V.value.month>n||H.value!==null&&c.value.year===H.value.year&&H.value.month<n,l=b.value.monthsShort.map((n,o)=>{const h=c.value.month===o+1;return d("div",{class:"q-date__months-item flex flex-center"},[d(D,{class:e===!0&&P.value.month===o+1?"q-date__today":null,flat:h!==!0,label:n,unelevated:h,color:h===!0?ee.value:null,textColor:h===!0?oe.value:null,tabindex:q.value,disable:t(o+1),...Y("month#"+o,{onClick:()=>{St(o+1)}})})])});return a.yearsInMonthView===!0&&l.unshift(d("div",{class:"row no-wrap full-width"},[Be({label:c.value.year,type:"Years",key:c.value.year,dir:Me.value,goTo:Qe,boundaries:He.value.year,cls:" col"})])),d("div",{key:"months-view",class:"q-date__view q-date__months flex flex-center"},l)},Years(){const e=ye.value,t=e+U,l=[],n=o=>V.value!==null&&V.value.year>o||H.value!==null&&H.value.year<o;for(let o=e;o<=t;o++){const h=c.value.year===o;l.push(d("div",{class:"q-date__years-item flex flex-center"},[d(D,{key:"yr"+o,class:P.value.year===o?"q-date__today":null,flat:!h,label:o,dense:!0,unelevated:h,color:h===!0?ee.value:null,textColor:h===!0?oe.value:null,tabindex:q.value,disable:n(o),...Y("yr#"+o,{onClick:()=>{Ht(o)}})})]))}return d("div",{class:"q-date__view q-date__years flex flex-center"},[d("div",{class:"col-auto"},[d(D,{round:!0,dense:!0,flat:!0,icon:xe.value[0],"aria-label":w.lang.date.prevRangeYears(U),tabindex:q.value,disable:n(e),...Y("y-",{onClick:()=>{ye.value-=U}})})]),d("div",{class:"q-date__years-content col self-stretch row items-center"},l),d("div",{class:"col-auto"},[d(D,{round:!0,dense:!0,flat:!0,icon:xe.value[1],"aria-label":w.lang.date.nextRangeYears(U),tabindex:q.value,disable:n(t),...Y("y+",{onClick:()=>{ye.value+=U}})})])])}};function Ot(e){const t={...c.value,day:e};if(a.range===!1){It(t,B.value);return}if(I.value===null){const l=Je.value.find(o=>o.fill!==!0&&o.i===e);if(a.noUnset!==!0&&l.range!==void 0){je({target:t,from:l.range.from,to:l.range.to});return}if(l.selected===!0){je(t);return}const n=X(t);I.value={init:t,initHash:n,final:t,finalHash:n},g("rangeStart",te(t))}else{const l=I.value.initHash,n=X(t),o=l<=n?{from:I.value.init,to:t}:{from:t,to:I.value.init};I.value=null,Oe(l===n?t:{target:t,...o}),g("rangeEnd",{from:te(o.from),to:te(o.to)})}}function jt(e){if(I.value!==null){const t={...c.value,day:e};Object.assign(I.value,{final:t,finalHash:X(t)})}}return Object.assign(Q,{setToday:We,setView:pt,offsetCalendar:Yt,setCalendarTo:Ie,setEditingRange:Vt}),()=>{const e=[d("div",{class:"q-date__content col relative-position"},[d(fe,{name:"q-transition--fade"},Qt[O.value])])],t=Nt(E.default);return t!==void 0&&e.push(d("div",{class:"q-date__actions"},t)),a.name!==void 0&&a.disable!==!0&&v(e,"push"),d("div",{class:_t.value,...Mt.value},[Lt(),d("div",{ref:F,class:"q-date__main col column",tabindex:-1},e)])}}}),va=["top","middle","bottom"],ft=gt({name:"QBadge",props:{color:String,textColor:String,floating:Boolean,transparent:Boolean,multiLine:Boolean,outline:Boolean,rounded:Boolean,label:[Number,String],align:{type:String,validator:a=>va.includes(a)}},setup(a,{slots:E}){const g=m(()=>a.align!==void 0?{verticalAlign:a.align}:null),Q=m(()=>{const w=a.outline===!0&&a.color||a.textColor;return`q-badge flex inline items-center no-wrap q-badge--${a.multiLine===!0?"multi":"single"}-line`+(a.outline===!0?" q-badge--outline":a.color!==void 0?` bg-${a.color}`:"")+(w!==void 0?` text-${w}`:"")+(a.floating===!0?" q-badge--floating":"")+(a.rounded===!0?" q-badge--rounded":"")+(a.transparent===!0?" q-badge--transparent":"")});return()=>d("div",{class:Q.value,style:g.value,role:"status","aria-label":a.label},zt(E.default,a.label!==void 0?[a.label]:[]))}}),ma={class:"row items-center q-gutter-x-md gt-sm"},fa={class:"q-pa-md"},ga={key:0,class:"q-pa-md text-center text-grey"},ha=["src"],ya={class:"q-pa-md bg-orange-1"},_a={class:"row items-center q-mb-md"},ba=["src"],xa={class:"text-subtitle1 text-weight-bold"},wa={class:"q-pa-md"},qa={key:0,class:"q-pa-md text-center text-grey"},Da={class:"bg-white text-grey-8 q-pt-xl q-pb-lg q-mt-xl rounded-top-xl relative-position"},ka={class:"q-px-xl"},Ca={class:"row q-col-gutter-xl"},Ma={class:"col-12 col-md-8"},pa={class:"row items-center q-mb-md cursor-pointer"},Ya={class:"row q-gutter-sm"},Va={class:"col-12 col-md-4"},Ha={class:"bg-orange-1 rounded-borders q-pa-lg"},Sa={class:"text-subtitle1 text-weight-bold text-primary q-mb-sm"},Ka={__name:"defaultLayout",setup(a){const E=Ut(),g=Pt(),Q=A(!1),w=()=>{Q.value=!Q.value},J=A(new Date().toISOString().slice(0,10).replace(/-/g,"/")),Y=m(()=>(g.pointLog||[]).filter(k=>k.event==="每日簽到").map(k=>Re.formatDate(k.createdAt,"YYYY/MM/DD"))),q=m(()=>{if(!g.pointLog)return[];const k=g.lastReadLogDate,v=k?new Date(k):new Date(0),F=new Date;return F.setHours(0,0,0,0),[...g.pointLog].filter(u=>{const b=new Date(u.createdAt);return b>=F||b>v}).sort((u,b)=>new Date(b.createdAt)-new Date(u.createdAt))}),S=A(0);de([()=>g.pointLog,()=>g.lastReadLogDate],([k,v])=>{k&&(v?S.value=k.filter(F=>new Date(F.createdAt)>new Date(v)).length:S.value=k.length)},{immediate:!0,deep:!0});const R=async()=>{try{const{data:k}=await ut.updateLastReadLog();g.lastReadLogDate=k.result.lastReadLogDate,S.value=0}catch(k){console.log(k)}},z=m(()=>[{title:"精選食譜",to:"/recipes",icon:"menu_book",show:!0},{title:"廚藝論壇",to:"/articles",icon:"forum",show:!0},{title:"登入",to:"/login",icon:"mdi-login",show:!g.isLoggedIn},{title:"會員中心",to:"/userProfile",icon:"mdi-account",show:g.isLoggedIn&&!g.isAdmin},{title:"管理",to:"/admin",icon:"mdi-cog",show:g.isLoggedIn&&g.isAdmin}]),ne=async()=>{try{await ut.logout()}catch(k){console.log(k)}g.logout(),Q.value=!1,E.push("/")};return(k,v)=>{const F=Jt("router-view");return x(),j(la,{view:"hHh lpR fFf",class:"bg-cream font-sans"},{default:s(()=>[i(na,{class:"bg-cream q-py-xs","height-hint":"80",style:{color:"#333333"}},{default:s(()=>[i(aa,{class:"q-px-lg"},{default:s(()=>[i(D,{flat:"",dense:"",round:"",icon:"menu",class:"lt-md q-mr-sm",onClick:w,color:"primary"}),y("div",{class:"row items-center cursor-pointer q-mr-md",onClick:v[0]||(v[0]=u=>M(E).push("/"))},[i(ae,{name:"soup_kitchen",color:"primary",size:"32px",class:"q-mr-sm"}),v[4]||(v[4]=y("div",{class:"text-h6 text-weight-bold text-primary tracking-wide text-shadow-title"}," 私房的料理探索 ",-1))]),i(Kt),y("div",ma,[(x(!0),$(K,null,De(z.value,u=>(x(),$(K,{key:u.to},[u.show?(x(),j(D,{key:0,stretch:"",flat:"",icon:u.icon,label:u.title,to:u.to,class:"text-weight-medium"},null,8,["icon","label","to"])):L("",!0)],64))),128)),M(g).isLoggedIn?(x(),j(D,{key:0,round:"",flat:"",icon:"event_available",color:"grey-7"},{default:s(()=>[i(Ae,null,{default:s(()=>[...v[5]||(v[5]=[C("簽到紀錄",-1)])]),_:1}),i(ke,null,{default:s(()=>[y("div",fa,[v[6]||(v[6]=y("div",{class:"text-subtitle1 q-mb-sm text-center text-weight-bold"},"簽到紀錄",-1)),i(mt,{modelValue:J.value,"onUpdate:modelValue":v[1]||(v[1]=u=>J.value=u),events:Y.value,"event-color":"green",minimal:"",flat:"",readonly:""},null,8,["modelValue","events"])])]),_:1})]),_:1})):L("",!0),M(g).isLoggedIn?(x(),j(D,{key:1,round:"",flat:"",icon:"notifications",color:"grey-7",onClick:R},{default:s(()=>[S.value>0?(x(),j(ft,{key:0,color:"red",floating:"",rounded:""},{default:s(()=>[C(p(S.value),1)]),_:1})):L("",!0),i(ke,null,{default:s(()=>[i(Fe,{style:{"min-width":"300px","max-height":"400px"},class:"scroll"},{default:s(()=>[i(G,{header:""},{default:s(()=>[...v[7]||(v[7]=[C("通知",-1)])]),_:1}),q.value.length===0?(x(),$("div",ga," 暫無通知 ")):L("",!0),(x(!0),$(K,null,De(q.value,u=>(x(),$(K,{key:u._id},[i(Ce,null,{default:s(()=>[i(N,{avatar:""},{default:s(()=>[i(ae,{name:u.type==="獲得"?"check_circle":"lock_open",color:u.type==="獲得"?"green":"deep-orange"},null,8,["name","color"])]),_:2},1024),i(N,null,{default:s(()=>[i(G,null,{default:s(()=>[C(p(u.title),1)]),_:2},1024),i(G,{caption:""},{default:s(()=>[C(p(u.description),1)]),_:2},1024),i(G,{caption:"",class:"text-grey-5"},{default:s(()=>[C(p(M(Re).formatDate(u.createdAt,"YYYY/MM/DD HH:mm")),1)]),_:2},1024)]),_:2},1024),i(N,{side:""},{default:s(()=>[y("span",{class:nt(u.type==="獲得"?"text-green":"text-deep-orange")},p(u.type==="獲得"?"+":"-")+p(u.amount),3)]),_:2},1024)]),_:2},1024),i(ge,{inset:""})],64))),128))]),_:1})]),_:1})]),_:1})):L("",!0),M(g).isLoggedIn?(x(),j(dt,{key:2,class:"bg-primary text-white text-weight-bold q-px-md",icon:"monetization_on"},{default:s(()=>[C(p(M(g).points??0),1)]),_:1})):L("",!0),M(g).isLoggedIn?(x(),j(ot,{key:3,size:"40px",class:"cursor-pointer shadow-1"},{default:s(()=>[y("img",{src:`https://api.dicebear.com/9.x/thumbs/svg?seed=${M(g).account}`},null,8,ha)]),_:1})):L("",!0),M(g).isLoggedIn?(x(),j(D,{key:4,flat:"",round:"",icon:"mdi-logout",color:"grey-7",onClick:ne},{default:s(()=>[i(Ae,null,{default:s(()=>[...v[8]||(v[8]=[C("登出",-1)])]),_:1})]),_:1})):L("",!0)])]),_:1})]),_:1}),i(oa,{modelValue:Q.value,"onUpdate:modelValue":v[3]||(v[3]=u=>Q.value=u),side:"left",overlay:"",behavior:"mobile",class:"bg-cream",width:280},{default:s(()=>[i(ra,{class:"fit"},{default:s(()=>[y("div",ya,[y("div",_a,[i(ot,{size:"56px",class:"shadow-2 q-mr-md bg-white"},{default:s(()=>[y("img",{src:`https://api.dicebear.com/9.x/thumbs/svg?seed=${M(g).account||"訪客"}`},null,8,ba)]),_:1}),y("div",null,[y("div",xa,p(M(g).account||"訪客"),1),i(dt,{size:"sm",color:"primary","text-color":"white",icon:"monetization_on",class:"q-ma-none"},{default:s(()=>[C(p(M(g).isLoggedIn?M(g).points??0:"-"),1)]),_:1})])]),M(g).isLoggedIn?(x(),j(D,{key:0,round:"",flat:"",icon:"event_available",color:"grey-7"},{default:s(()=>[i(Ae,null,{default:s(()=>[...v[9]||(v[9]=[C("簽到紀錄",-1)])]),_:1}),i(ke,null,{default:s(()=>[y("div",wa,[v[10]||(v[10]=y("div",{class:"text-subtitle1 q-mb-sm text-center text-weight-bold"},"簽到紀錄",-1)),i(mt,{modelValue:J.value,"onUpdate:modelValue":v[2]||(v[2]=u=>J.value=u),events:Y.value,"event-color":"green",minimal:"",flat:"",readonly:""},null,8,["modelValue","events"])])]),_:1})]),_:1})):L("",!0),M(g).isLoggedIn?(x(),j(D,{key:1,round:"",flat:"",icon:"notifications",color:"grey-7",onClick:R},{default:s(()=>[S.value>0?(x(),j(ft,{key:0,color:"red",floating:"",rounded:""},{default:s(()=>[C(p(S.value),1)]),_:1})):L("",!0),i(ke,null,{default:s(()=>[i(Fe,{style:{"min-width":"300px","max-height":"400px"},class:"scroll"},{default:s(()=>[i(G,{header:""},{default:s(()=>[...v[11]||(v[11]=[C("通知",-1)])]),_:1}),q.value.length===0?(x(),$("div",qa," 暫無通知 ")):L("",!0),(x(!0),$(K,null,De(q.value,u=>(x(),$(K,{key:u._id},[i(Ce,null,{default:s(()=>[i(N,{avatar:""},{default:s(()=>[i(ae,{name:u.type==="獲得"?"check_circle":"lock_open",color:u.type==="獲得"?"green":"deep-orange"},null,8,["name","color"])]),_:2},1024),i(N,null,{default:s(()=>[i(G,null,{default:s(()=>[C(p(u.title),1)]),_:2},1024),i(G,{caption:""},{default:s(()=>[C(p(u.description),1)]),_:2},1024),i(G,{caption:"",class:"text-grey-5"},{default:s(()=>[C(p(M(Re).formatDate(u.createdAt,"YYYY/MM/DD HH:mm")),1)]),_:2},1024)]),_:2},1024),i(N,{side:""},{default:s(()=>[y("span",{class:nt(u.type==="獲得"?"text-green":"text-deep-orange")},p(u.type==="獲得"?"+":"-")+p(u.amount),3)]),_:2},1024)]),_:2},1024),i(ge,{inset:""})],64))),128))]),_:1})]),_:1})]),_:1})):L("",!0)]),i(ge,{color:"orange-2"}),i(Fe,{padding:"",class:"text-grey-9"},{default:s(()=>[(x(!0),$(K,null,De(z.value,u=>(x(),$(K,{key:u.to},[u.show?rt((x(),j(Ce,{key:0,clickable:"",to:u.to,"active-class":"text-primary bg-orange-1"},{default:s(()=>[i(N,{avatar:""},{default:s(()=>[i(ae,{name:u.icon},null,8,["name"])]),_:2},1024),i(N,{class:"text-weight-medium"},{default:s(()=>[C(p(u.title),1)]),_:2},1024)]),_:2},1032,["to"])),[[it]]):L("",!0)],64))),128)),i(ge,{class:"q-my-md"}),M(g).isLoggedIn?rt((x(),j(Ce,{key:0,clickable:"",onClick:ne,class:"text-red"},{default:s(()=>[i(N,{avatar:""},{default:s(()=>[i(ae,{name:"mdi-logout"})]),_:1}),i(N,null,{default:s(()=>[...v[12]||(v[12]=[C("登出",-1)])]),_:1})]),_:1})),[[it]]):L("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),i(ia,null,{default:s(()=>[i(F)]),_:1}),y("div",Da,[v[18]||(v[18]=y("div",{class:"absolute-top bg-primary",style:{height:"4px",opacity:"0.1"}},null,-1)),y("div",ka,[y("div",Ca,[y("div",Ma,[y("div",pa,[i(ae,{name:"soup_kitchen",color:"primary",size:"32px",class:"q-mr-sm"}),v[13]||(v[13]=y("div",{class:"text-h6 text-weight-bold text-primary tracking-wide text-shadow-title"}," 私房的料理探索 ",-1))]),v[14]||(v[14]=y("div",{class:"text-body2 text-grey-6 q-mb-lg",style:{"line-height":"1.8","max-width":"500px"}}," 連結每一位熱愛烹飪的靈魂，讓味道成為記憶的載體。加入我們，開啟你的味蕾探險之旅。 ",-1)),y("div",Ya,[i(D,{round:"",flat:"",color:"grey-6",icon:"facebook",class:"hover-primary"}),i(D,{round:"",flat:"",color:"grey-6",icon:"smart_display",class:"hover-primary"}),i(D,{round:"",flat:"",color:"grey-6",icon:"photo_camera",class:"hover-primary"})])]),y("div",Va,[y("div",Ha,[y("div",Sa,[i(ae,{name:"mail",class:"q-mr-xs"}),v[15]||(v[15]=C(" 訂閱每週靈感 ",-1))]),v[16]||(v[16]=y("div",{class:"text-caption text-grey-7 q-mb-md"}," 不想錯過獨家食譜？輸入 Email，將美味送到你信箱！ ",-1)),i(Wt,{dense:"",outlined:"","bg-color":"white",placeholder:"your@email.com",class:"rounded-input"},{append:s(()=>[i(D,{round:"",dense:"",flat:"",icon:"arrow_forward",color:"primary"})]),_:1})])])]),i(ge,{class:"q-my-lg bg-grey-3"}),v[17]||(v[17]=y("div",{class:"row justify-center items-center text-caption text-grey-5"},[y("div",null,"© 2026 私房的料理探索. All rights reserved.")],-1))])])]),_:1})}}};export{Ka as default};
