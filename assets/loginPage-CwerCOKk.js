import{I as q,z as _,U as k,J as $,h as A,o as B,j as n,b as u,e as r,N as U,K as s,S as g,aD as f,L as j,Q as b}from"./index-CCltDTcc.js";import{Q as C}from"./QForm-CoHpBmVC.js";import{Q as F}from"./QPage-DfUJbLHa.js";import{c as I,a as v,v as y,u as N,d as V}from"./index.esm-6MkVtUNW.js";import{u as P}from"./use-quasar-CUmE3VzD.js";const E={class:"col-12 col-md-6 col-lg-4 q-pa-md"},M={class:"row justify-end"},G={__name:"loginPage",setup(R){const m=P(),c=$(),w=q(),a=_(!1),x=I({account:v().required("帳號必填").min(4,"最少4個字").max(20,"最多20個字").test("isAlphanumeric","帳號只能是英、數字",o=>o?y.isAlphanumeric(o):!0),password:v().required("密碼必填").min(4,"密碼最少8個字").max(20,"密碼最多20個字").test("isAscii","密碼只能是英、數字、特殊符號",o=>o?y.isAscii(o):!0)}),{handleSubmit:h,isSubmitting:Q}=N({validationSchema:x,initialValues:{account:"",password:""}}),{value:l,errorMessage:d}=V("account"),{value:i,errorMessage:p}=V("password"),S=h(async o=>{try{const{data:e}=await k.login(o);w.login(e.result),m.notify({message:"登入成功",color:"positive",icon:"check_circle",position:"bottom"}),c.push("/")}catch(e){console.log(e);const t=e?.response?.data?.message||"發生錯誤";m.notify({message:t,color:"negative",icon:"error",position:"bottom"})}});return(o,e)=>(B(),A(F,{class:"row justify-center items-center"},{default:n(()=>[u("div",E,[e[4]||(e[4]=u("h1",{class:"text-h3 text-center q-mb-md"},"登入",-1)),r(U,{class:"q-my-md"}),r(C,{onSubmit:s(S),class:"q-gutter-y-md"},{default:n(()=>[r(g,{modelValue:s(l),"onUpdate:modelValue":e[0]||(e[0]=t=>f(l)?l.value=t:null),label:"帳號",hint:"長度 4 ~ 20 的英數字",counter:"",maxlength:"20",error:!!s(d),"error-message":s(d),outlined:"",dense:""},null,8,["modelValue","error","error-message"]),r(g,{modelValue:s(i),"onUpdate:modelValue":e[2]||(e[2]=t=>f(i)?i.value=t:null),label:"密碼",hint:"長度 4 ~ 20 的英數字、特殊符號",type:a.value?"text":"password",counter:"",maxlength:"20",error:!!s(p),"error-message":s(p),outlined:"",dense:""},{append:n(()=>[r(j,{name:a.value?"visibility":"visibility_off",class:"cursor-pointer",onClick:e[1]||(e[1]=t=>a.value=!a.value)},null,8,["name"])]),_:1},8,["modelValue","type","error","error-message"]),u("div",M,[r(b,{type:"button",flat:"",label:"註冊",color:"primary",onClick:e[3]||(e[3]=t=>s(c).push("/register"))}),r(b,{label:"登入",flat:"",type:"submit",color:"primary",loading:s(Q)},null,8,["loading"])])]),_:1},8,["onSubmit"])])]),_:1}))}};export{G as default};
