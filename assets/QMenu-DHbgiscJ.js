import{q as Q,l as P,aL as ne,aU as se,b4 as ue,u as le,aM as ie,v as ce,z as w,p as u,x as re,a7 as de,a8 as fe,bc as ve,aN as ge,bd as he,B as M,bt as me,bu as A,bv as be,ap as ye,bw as Pe,aV as Te,bx as Se,by as ke,E as xe,D as Ce,X as qe,b9 as Ee,a6 as Oe}from"./index-CCltDTcc.js";import{v as Be,a as R,e as Fe,b as De,c as we,p as H,d as Me,r as K,s as Ae}from"./position-engine-DhZ2HoGy.js";const Ke=Q({name:"QSpace",setup(){const e=P("div",{class:"q-space"});return()=>e}}),Qe=Q({name:"QMenu",inheritAttrs:!1,props:{...Fe,...ie,...le,...ue,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noEscDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:R},self:{type:String,validator:R},offset:{type:Array,validator:Be},scrollTarget:se,touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...ne,"click","escapeKey"],setup(e,{slots:W,emit:r,attrs:f}){let n=null,d,l,v;const T=ce(),{proxy:g}=T,{$q:o}=g,a=w(null),s=w(!1),L=u(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),U=re(e,o),{registerTick:_,removeTick:j}=de(),{registerTimeout:S}=fe(),{transitionProps:z,transitionStyle:I}=ve(e),{localScrollTarget:k,changeScrollEvent:N,unconfigureScrollTarget:V}=De(e,F),{anchorEl:i,canShow:X}=we({showing:s}),{hide:x}=ge({showing:s,canShow:X,handleShow:Z,handleHide:p,hideOnRouteChange:L,processOnMount:!0}),{showPortal:C,hidePortal:q,renderPortal:$}=he(T,a,te,"menu"),h={anchorEl:i,innerRef:a,onClickOutside(t){if(e.persistent!==!0&&s.value===!0)return x(t),(t.type==="touchstart"||t.target.classList.contains("q-dialog__backdrop"))&&Oe(t),!0}},E=u(()=>H(e.anchor||(e.cover===!0?"center middle":"bottom start"),o.lang.rtl)),G=u(()=>e.cover===!0?E.value:H(e.self||"top start",o.lang.rtl)),J=u(()=>(e.square===!0?" q-menu--square":"")+(U.value===!0?" q-menu--dark q-dark":"")),Y=u(()=>e.autoClose===!0?{onClick:ee}:{}),O=u(()=>s.value===!0&&e.persistent!==!0);M(O,t=>{t===!0?(me(b),Me(h)):(A(b),K(h))});function m(){Ee(()=>{let t=a.value;t&&t.contains(document.activeElement)!==!0&&(t=t.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||t.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||t.querySelector("[autofocus], [data-autofocus]")||t,t.focus({preventScroll:!0}))})}function Z(t){if(n=e.noRefocus===!1?document.activeElement:null,be(D),C(),F(),d=void 0,t!==void 0&&(e.touchPosition||e.contextMenu)){const y=ye(t);if(y.left!==void 0){const{top:oe,left:ae}=i.value.getBoundingClientRect();d={left:y.left-ae,top:y.top-oe}}}l===void 0&&(l=M(()=>o.screen.width+"|"+o.screen.height+"|"+e.self+"|"+e.anchor+"|"+o.lang.rtl,c)),e.noFocus!==!0&&document.activeElement.blur(),_(()=>{c(),e.noFocus!==!0&&m()}),S(()=>{o.platform.is.ios===!0&&(v=e.autoClose,a.value.click()),c(),C(!0),r("show",t)},e.transitionDuration)}function p(t){j(),q(),B(!0),n!==null&&(t===void 0||t.qClickOutside!==!0)&&(((t?.type.indexOf("key")===0?n.closest('[tabindex]:not([tabindex^="-"])'):void 0)||n).focus(),n=null),S(()=>{q(!0),r("hide",t)},e.transitionDuration)}function B(t){d=void 0,l!==void 0&&(l(),l=void 0),(t===!0||s.value===!0)&&(Pe(D),V(),K(h),A(b)),t!==!0&&(n=null)}function F(){(i.value!==null||e.scrollTarget!==void 0)&&(k.value=Te(i.value,e.scrollTarget),N(k.value,c))}function ee(t){v!==!0?(Se(g,t),r("click",t)):v=!1}function D(t){O.value===!0&&e.noFocus!==!0&&ke(a.value,t.target)!==!0&&m()}function b(t){e.noEscDismiss!==!0&&(r("escapeKey"),x(t))}function c(){Ae({targetEl:a.value,offset:e.offset,anchorEl:i.value,anchorOrigin:E.value,selfOrigin:G.value,absoluteOffset:d,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function te(){return P(Ce,z.value,()=>s.value===!0?P("div",{role:"menu",...f,ref:a,tabindex:-1,class:["q-menu q-position-engine scroll"+J.value,f.class],style:[f.style,I.value],...Y.value},xe(W.default)):null)}return qe(B),Object.assign(g,{focus:m,updatePosition:c}),$}});export{Ke as Q,Qe as a};
